<!doctype html>
<html lang="zh-CN">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>宠物喂食工具集 · 404</title>
  <meta name="robots" content="noindex" />
  <meta name="referrer" content="strict-origin-when-cross-origin" />
  <!-- Content-Security-Policy：允许本域与 plausible.io -->
  <meta http-equiv="Content-Security-Policy" content="
    default-src 'self';
    img-src 'self' https: data:;
    script-src 'self' https://plausible.io 'unsafe-inline';
    style-src 'self' 'unsafe-inline';
    connect-src https://plausible.io;
    form-action 'self' https://github.com mailto:;
    base-uri 'none';
    frame-ancestors 'self';
  ">
  <meta name="theme-color" content="#0b0c0f" />
  <link id="favicon" rel="icon" href="data:,">
  <style>
    :root{color-scheme:light dark}
    body{font:16px/1.7 system-ui,-apple-system,Segoe UI,Roboto,PingFang SC,Noto Sans,Helvetica,Arial,sans-serif;margin:48px 16px;max-width:720px}
    a.btn{display:inline-block;padding:.6rem 1rem;border:1px solid color-mix(in oklab, CanvasText 20%, Canvas 80%);border-radius:12px;text-decoration:none}
    .muted{opacity:.8}
  </style>
</head>
<body>
  <h1>宠物喂食工具集</h1>
  <p>404 — Page not found.</p>
  <p class="muted">本页启用匿名统计（Plausible），仅用于改进产品体验。</p>
  <p><a id="homeBtn" class="btn" href="#">返回主页</a></p>

  <!-- 统一脚本（包含：项目根修正 + Plausible 队列 shim + 404 事件上报） -->
  <script>
  (function () {
    /* 1) 计算项目根（GitHub Pages 项目站） */
    var seg  = (location.pathname || '/').split('/').filter(Boolean);
    var repo = seg.length ? seg[0] : 'p-feeding';   // 例如 "p-feeding"
    var base = '/' + repo + '/';

    /* 2) 修正“返回主页” & favicon（i18n 可选加载，缺失不报错） */
    var home = document.getElementById('homeBtn'); if (home) home.href = base;
    var fav  = document.getElementById('favicon'); if (fav)  fav.href  = base + 'cover.png';
    try {
      var i18n = document.createElement('script');
      i18n.defer = true; i18n.src = base + 'i18n.js?v=20250920b';
      i18n.onerror = function(){}; document.head.appendChild(i18n);
    } catch(_) {}

    /* 3) Plausible 官方队列 shim —— 事件先入队，脚本就绪后自动发送 */
    window.plausible = window.plausible || function(){ (window.plausible.q = window.plausible.q || []).push(arguments); };

    /* 4) 注入 Plausible 主脚本（自动使用当前真实域名为 data-domain） */
    var s = document.createElement('script');
    s.defer = true;
    s.setAttribute('data-domain', location.hostname || 'localhost');
    s.src = 'https://plausible.io/js/script.js';
    document.head.appendChild(s);

    /* 5) 发送自定义 404 事件（在 Plausible → Settings → Goals 里添加 Custom event: 404） */
    plausible('404', { props: {
      path: location.pathname + location.search,
      referrer: document.referrer,
      tag: 'queued'
    }});
  })();
  </script>
</body>
</html>
