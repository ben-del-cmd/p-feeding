<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Not Found</title>
  <link rel="stylesheet" href="assets/site.css?v=20250920b">
  <script defer data-domain="" src="https://plausible.io/js/script.js"></script>
  <script>
    (function(){
      var u=new URL(location.href);
      var cur=u.searchParams.get('lang')||localStorage.getItem('lang')||'en';
      if(!u.searchParams.get('lang')){ u.searchParams.set('lang',cur); history.replaceState(null,'',u.toString()); }
      document.documentElement.setAttribute('lang', cur);
      localStorage.setItem('lang', cur);
    })();
  </script>
  <style>
    :root{ --maxw: 720px; }
    body{ margin:0; display:flex; min-height:100vh; align-items:center; justify-content:center; font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto; }
    main{ max-width:var(--maxw); padding:24px; text-align:center; }
    .btn{ padding:10px 14px; border-radius:10px; border:1px solid #ddd; display:inline-block; }
    .note{ font-size:12px; opacity:.8; }
  </style>
</head>
<body>
<main>
  <h1 data-i18n="404.title">Page not found</h1>
  <p data-i18n="404.subtitle">This page doesn't exist. Let's get you back.</p>
  <p><a class="btn" id="back-home" href="index.html" data-i18n="404.back_home">Back to Home</a></p>
  <p class="note" data-i18n="footer.disclaimer">For diet/medical questions, consult your veterinarian.</p>
</main>
<script>
  // 事件队列 shim，确保脚本慢加载也能记录一次 404
  (function(){
    window.ps = window.ps || {};
    var q=[]; ps._q=q;
    ps.events = ps.events || {
      page:  function(n,p){ q.push(['page',n,p||{}]); },
      event: function(n,p){ q.push(['event',n,p||{}]); }
    };
    window.addEventListener('load', function(){
      try{
        var lang=(new URL(location.href)).searchParams.get('lang')||localStorage.getItem('lang')||'en';
        q.forEach(function([t,n,p]){
          if(t==='page' && typeof plausible==='function') plausible('pageview',{props:Object.assign({page_name:n,lang:lang},p||{})});
          if(t==='event'&& typeof plausible==='function') plausible(n,{props:Object.assign({lang:lang},p||{})});
        });
        ps._q=[];
      }catch(e){}
    });
  })();

  (function(){
    function lang(){ try{var u=new URL(location.href); return u.searchParams.get('lang')||localStorage.getItem('lang')||'en';}catch(e){return'en';} }
    // 保留 ?lang
    (function(){
      var l=lang();
      var a=document.getElementById('back-home');
      if(a){
        var url=new URL(a.getAttribute('href'), location.href);
        var sp=url.searchParams; if(!sp.get('lang')) sp.set('lang', l); url.search=sp.toString();
        a.setAttribute('href', url.pathname + (url.search?('?'+url.search):'') + url.hash);
      }
    })();
    // 上报 404
    if(window.ps && ps.events) ps.events.event('custom_404');
    else if(typeof plausible==='function') plausible('custom_404', { props:{ lang: lang() } });
  })();
</script>
</body>
</html>
