<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Pet Scan — Home</title>
  <meta name="description" content="Turn pet food & wash labels into simple, actionable feeding & transition tips. Informational only. Not medical advice.">

  <!-- HOTFIX-01: 自愈 ?%3F / ?%253F -->
  <script>(function(){var q=location.search;if(/^\?%253F/i.test(q))location.replace(location.pathname+'?'+q.replace(/^\?%253F/i,''));else if(/^\?%3F/i.test(q))location.replace(location.pathname+'?'+q.replace(/^\?%3F/i,''));})();</script>

  <!-- 默认语言：英文优先 -->
  <script>(function(){var u=new URL(location.href);var cur=u.searchParams.get('lang')||localStorage.getItem('lang')||'en';if(!u.searchParams.get('lang')){u.searchParams.set('lang',cur);history.replaceState(null,'',u.toString());}document.documentElement.lang=cur;localStorage.setItem('lang',cur);})();</script>

  <link rel="stylesheet" href="assets/site.css?v=20250920b" />

  <!-- Plausible -->
  <script>(function(){var DOMAIN='ben-del-cmd.github.io';window.plausible=window.plausible||function(){(window.plausible.q=window.plausible.q||[]).push(arguments)};if(!document.querySelector('script[data-plausible][data-domain="'+DOMAIN+'"]')){var s=document.createElement('script');s.defer=true;s.src='https://plausible.io/js/script.js';s.setAttribute('data-domain',DOMAIN);s.setAttribute('data-plausible','');document.head.appendChild(s);}})();</script>

  <script src="i18n.js?v=20250923" defer></script>
  <script src="assets/js/events.js?v=20250923" defer></script>

  <!-- 全站链接热补丁（去 %3F、去重复 lang） -->
  <script>
  (function(){
    function curLang(){try{const u=new URL(location.href);return u.searchParams.get('lang')||localStorage.getItem('lang')||'en'}catch(e){return'en'}}
    function normalize(u,l){if(/^\?%3F/i.test(u.search))u.search='?'+u.search.replace(/^\?%3F/i,'');if(/^\?%253F/i.test(u.search))u.search='?'+u.search.replace(/^\?%253F/i,'');u.searchParams.delete('lang');u.searchParams.set('lang',l||'en');return u.pathname+u.search+u.hash}
    function rewriteAll(){var l=curLang();document.querySelectorAll('a[href]').forEach(function(a){var h=a.getAttribute('href');if(!h||h.startsWith('#')||/^https?:\/\//i.test(h))return;var u=new URL(h,location.href);a.setAttribute('href',normalize(u,l));});}
    document.addEventListener('DOMContentLoaded',rewriteAll);
    document.addEventListener('click',function(ev){var a=ev.target&&ev.target.closest&&ev.target.closest('a[href]');if(!a)return;var h=a.getAttribute('href');if(!h||h.startsWith('#')||/^https?:\/\//i.test(h))return;var u=new URL(h,location.href),qs=u.searchParams.toString();var dup=/(^|&)lang=/.test(qs)&&(qs.match(/(^|&)lang=/g)||[]).length>1;var bad=/^\?%3F/i.test(u.search)||/^\?%253F/i.test(u.search);if(dup||bad){ev.preventDefault();location.href=normalize(u,curLang());}},true);
  })();
  </script>

  <style>
    :root{--maxw:960px}
    body{margin:0;line-height:1.45;font-family:ui-sans-serif,system-ui,-apple-system,Segoe UI,Roboto}
    header,main,footer{max-width:var(--maxw);margin:0 auto;padding:16px}
    nav a{margin-right:12px;text-decoration:none}
    .btn{padding:10px 14px;border-radius:10px;border:1px solid #ddd;display:inline-block}
    .hero{padding:32px 0}.note{font-size:12px;opacity:.8}
    .grid{display:grid;gap:16px;grid-template-columns:repeat(3,minmax(0,1fr))}
    .card{border:1px solid #e5e7eb;border-radius:14px;padding:16px}
  </style>
</head>
<body>
<header>
  <nav aria-label="Main">
    <a href="index.html" data-i18n="nav.home">Home</a>
    <a href="feeding.html" data-i18n="nav.calculator">Calculator</a>
    <a href="cards/transition-7.html" data-i18n="nav.transition7">7-Day Switch</a>
    <a href="feedback.html" data-i18n="nav.feedback">Feedback</a>
  </nav>
  <div id="lang-slot" style="display:none"></div>
</header>

<main>
  <section class="hero">
    <h1 data-i18n="home.hero.title">Turn pet food labels into simple, actionable feeding.</h1>
    <p class="note" data-i18n="home.hero.subtitle">Scan → unify terms (ME, GA, as-fed/DM) → personalized portions → smooth transition → reorder.</p>
    <p class="note" data-i18n="legal.info_boundary">Informational only. Not medical advice.</p>
    <p>
      <!-- HOTFIX-02：点击强制规范 URL（注意这里改为 feeding.html 根级路径） -->
      <a id="open-calc" class="btn" href="feeding.html" data-i18n="home.cta.open_calculator">Open Calculator</a>
      <a class="btn" href="cards/transition-7.html" data-i18n="home.cta.view_transition_card">View 7-Day Card</a>
      <a class="btn" href="feedback.html" data-i18n="nav.feedback">Feedback</a>
    </p>
  </section>

  <section class="grid">
    <div class="card">
      <h2 data-i18n="nav.calculator">Calculator</h2>
      <p class="note" data-i18n="feeding.formula.note">RER = 70 × weight^0.75; MER = RER × activity.</p>
    </div>
    <div class="card">
      <h2 data-i18n="transition.title">7-Day Transition Card</h2>
      <p class="note">90/10 → 0/100</p>
    </div>
    <div class="card">
      <h2 data-i18n="nav.feedback">Feedback</h2>
      <p class="note" data-i18n="legal.data_use">We use anonymous analytics to improve features.</p>
    </div>
  </section>
</main>

<footer>
  <p class="note" data-i18n="footer.disclaimer">For diet/medical questions, consult your veterinarian.</p>
</footer>

<!-- HOTFIX-02：按钮兜底（指向 feeding.html） -->
<script>
(function(){
  function getLang(){try{var u=new URL(location.href);return u.searchParams.get('lang')||localStorage.getItem('lang')||'en'}catch(e){return'en'}}
  function norm(u,l){if(/^\?%3F/i.test(u.search))u.search='?'+u.search.replace(/^\?%3F/i,'');if(/^\?%253F/i.test(u.search))u.search='?'+u.search.replace(/^\?%253F/i,'');u.searchParams.delete('lang');u.searchParams.set('lang',l||'en');return u.pathname+u.search+u.hash}
  var a=document.getElementById('open-calc');if(a){a.addEventListener('click',function(e){e.preventDefault();var u=new URL('feeding.html',location.href);location.href=norm(u,getLang());},true);}
})();
</script>
</body>
</html>
