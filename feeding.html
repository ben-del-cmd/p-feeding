<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <title data-i18n="title.feeding">Feeding Calculator</title>
  <meta name="description" content="Quickly estimate daily calories and portion sizes for your pet." />
  <link rel="canonical" href="https://ben-del-cmd.github.io/p-feeding/feeding.html" />
  <link rel="icon" href="/p-feeding/cover.png">

  <!-- Security baseline -->
  <meta name="referrer" content="strict-origin-when-cross-origin">
  <meta http-equiv="Content-Security-Policy" content="default-src 'self'; img-src 'self' https: data:; script-src 'self' https://plausible.io 'unsafe-inline'; style-src 'self' 'unsafe-inline'; connect-src https://plausible.io; form-action 'self' https://github.com mailto:; base-uri 'none'; frame-ancestors 'self';">
  <meta name="theme-color" content="#0b0c0f">

  <!-- Open Graph -->
  <meta property="og:type" content="website" />
  <meta property="og:site_name" content="Pet Feeding Tools" />
  <meta property="og:title" content="Feeding Calculator" />
  <meta property="og:description" content="Quickly estimate daily calories and portion sizes for your pet." />
  <meta property="og:url" content="https://ben-del-cmd.github.io/p-feeding/feeding.html" />
  <meta property="og:image" content="https://ben-del-cmd.github.io/p-feeding/cover.png?v=20250919" />

  <!-- Plausible -->
  <script defer data-domain="ben-del-cmd.github.io" src="https://plausible.io/js/script.js"></script>
  <!-- i18n -->
  <script src="/p-feeding/i18n.js?v=20250920b" defer></script>

  <style>
    body{font-family:system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,"Noto Sans","PingFang SC","Hiragino Sans GB",sans-serif;line-height:1.6;margin:0;padding:0 16px 48px;color:#111}
    header{display:flex;gap:12px;align-items:center;padding:16px 0}
    .btn{display:inline-block;padding:10px 16px;border:1px solid #d0d7de;border-radius:8px;text-decoration:none;color:#111;background:#fff}
    .btn:hover{background:#f6f8fa}
    h1{font-size:40px;margin:16px 0}
    .langbar{display:flex;gap:12px;margin:16px 0}
    .card{border:1px solid #e5e7eb;border-radius:12px;padding:16px;margin:24px 0}
    input,select,button{padding:10px;border:1px solid #d0d7de;border-radius:8px}
  </style>
</head>
<body>
  <!-- 顶部“配置位”（必须保留；可按产品能量密度调整） -->
  <script>
    window.KCAL_PER_CUP = 360;  // 每杯千卡
    window.GRAMS_PER_CUP = 100; // 每杯克数
  </script>

  <header>
    <a class="btn" href="/p-feeding/" data-i18n="nav.home">Home</a>

    <div style="flex:1"></div>

    <!-- 语言切换 -->
    <div class="langbar" style="margin:0">
      <button class="btn" onclick="__setLang('en-US')">English</button>
      <button class="btn" onclick="__setLang('es-419')">Español</button>
      <button class="btn" onclick="__setLang('zh-Hans')">中文(简)</button>
      <button class="btn" onclick="__setLang('fr-CA')">Français (Canada)</button>
    </div>

    <!-- Feedback（已含点击事件） -->
    <a class="btn"
       href="/p-feeding/feedback.html"
       data-i18n="nav.feedback"
       onclick="try{plausible('feedback_click')}catch(e){}">
       Feedback
    </a>
  </header>

  <main>
    <h1 data-i18n="h1.feeding">Feeding Calculator</h1>

    <section class="card">
      <div style="display:grid;gap:16px;max-width:520px">
        <label>
          <span data-i18n="feeding.weight">Weight</span><br />
          <input id="w" type="number" value="10" min="0" step="0.1" />
        </label>

        <label>
          <span data-i18n="feeding.unit">Unit</span><br />
          <select id="u">
            <option value="kg" data-i18n="feeding.kg">Kilogram (kg)</option>
            <option value="lb" data-i18n="feeding.lb">Pound (lb)</option>
          </select>
        </label>

        <label>
          <span data-i18n="feeding.activity">Activity</span><br />
          <select id="a">
            <option value="low" data-i18n="feeding.low">Low</option>
            <option value="mid" data-i18n="feeding.mid">Medium</option>
            <option value="high" data-i18n="feeding.high">High</option>
          </select>
        </label>

        <button class="btn" id="calc" data-i18n="feeding.calc">Calculate</button>

        <div id="res">
          <strong data-i18n="feeding.result">Result</strong>
          <div id="r1">0 <span data-i18n="feeding.kcal.day">kcal/day</span></div>
          <div id="r2">0 <span data-i18n="feeding.cup.day">cup/day</span></div>
          <div id="r3">0 <span data-i18n="feeding.g.day">g/day</span></div>
        </div>

        <p class="muted" data-i18n="footer.note.feeding">Note: For reference only. Consult your vet.</p>
      </div>
    </section>
  </main>

  <script>
    // 计算
    function kcal(weightKg, activity){
      const base = 70 * Math.pow(weightKg, 0.75);
      const factor = activity === 'high' ? 1.8 : activity === 'mid' ? 1.5 : 1.2;
      return Math.round(base * factor);
    }
    function cupsFromKcal(k){
      var KPC = (window.KCAL_PER_CUP || 360);
      return (k / KPC).toFixed(1);
    }
    function gramsFromKcal(k){
      var KPC = (window.KCAL_PER_CUP || 360);
      var GPC = (window.GRAMS_PER_CUP || 100);
      return (k * (GPC / KPC)).toFixed(1);
    }

    document.getElementById('calc').addEventListener('click', function(){
      const w = parseFloat(document.getElementById('w').value || '0');
      const unit = document.getElementById('u').value;
      const act = document.getElementById('a').value;

      const kg = unit === 'lb' ? (w * 0.45359237) : w;
      const k = kcal(kg, act);

      document.getElementById('r1').firstChild.nodeValue = k + ' ';
      document.getElementById('r2').firstChild.nodeValue = cupsFromKcal(k) + ' ';
      document.getElementById('r3').firstChild.nodeValue = gramsFromKcal(k) + ' ';

      // 事件：计算发生（带单位与活动水平）
      try { plausible('calc_click', { props: { unit: unit, activity: act } }); } catch(e) {}
    });
  </script>
</body>
</html>
