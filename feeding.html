<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title data-i18n="title.feeding">Feeding Calculator</title>
  <link rel="icon" href="/p-feeding/cover.png"/>
  <style>
    :root { color-scheme: light dark; }
    body { font-family: system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial,"Apple Color Emoji","Segoe UI Emoji"; margin:0 auto; padding:24px; max-width:960px; line-height:1.6; }
    h1 { font-size:36px; margin:12px 0 18px; }
    a { color: inherit; }
    .top { display:flex; justify-content:space-between; align-items:center; gap:12px; flex-wrap:wrap; }
    .lang-row { display:flex; gap:10px; flex-wrap:wrap; }
    .pill { padding:8px 14px; border-radius:999px; border:1px solid rgb(120 120 120 / 35%); background:transparent; cursor:pointer; }
    .card { border:1px solid rgb(120 120 120 / 25%); border-radius:14px; padding:16px; margin:20px 0; }
    .row { display:grid; grid-template-columns: 120px 1fr 160px; gap:12px; align-items:center; margin:12px 0; }
    input, select { padding:10px 12px; border-radius:10px; border:1px solid rgb(120 120 120 / 35%); }
    .btn { padding:10px 16px; border-radius:10px; border:1px solid rgb(120 120 120 / 35%); background:transparent; cursor:pointer; font-weight:600;}
    .result { font-size:18px; line-height:1.8; margin-top:10px; }
    footer { margin-top: 28px; color:#888; font-size:14px; }
  </style>
  <!-- i18n -->
  <script src="/p-feeding/i18n.js?v=20250920b" defer></script>
</head>
<body>
  <div class="top">
    <a href="/p-feeding/" data-i18n="nav.home">Home</a>
    <div class="lang-row">
      <button class="pill" onclick="__setLang('en-US')">English</button>
      <button class="pill" onclick="__setLang('es-419')">Español</button>
      <button class="pill" onclick="__setLang('zh-Hans')">中文(简)</button>
      <button class="pill" onclick="__setLang('fr-CA')">Français (Canada)</button>
    </div>
  </div>

  <h1 data-i18n="h1.feeding">Feeding Calculator</h1>

  <div class="card">
    <div class="row">
      <label data-i18n="feeding.weight">Weight</label>
      <input id="w" type="number" min="0" step="0.1" value="10"/>
      <div></div>
    </div>

    <div class="row">
      <label data-i18n="feeding.activity">Activity</label>
      <select id="act">
        <option value="low" data-i18n="feeding.low">Low</option>
        <option value="mid" data-i18n="feeding.mid" selected>Medium</option>
        <option value="high" data-i18n="feeding.high">High</option>
      </select>
      <button class="btn" id="calc" data-i18n="feeding.calc">Calculate</button>
    </div>

    <div class="row">
      <label data-i18n="feeding.unit">Unit</label>
      <select id="unit">
        <option value="kg" data-i18n="feeding.kg" selected>Kilogram (kg)</option>
        <option value="lb" data-i18n="feeding.lb">Pound (lb)</option>
      </select>
      <div></div>
    </div>

    <div class="result">
      <div><strong data-i18n="feeding.result">Result</strong></div>
      <div id="r-kcal">—</div>
      <div id="r-cup">—</div>
      <div id="r-gram">—</div>
    </div>
  </div>

  <footer data-i18n="footer.note.feeding">Note: For reference only. Consult your vet.</footer>

<script>
  // 简洁版计算逻辑：与截图一致的系数
  // RER = 70 * kg^0.75; 活动系数：低1.2 / 中1.4 / 高1.6
  // 360 kcal/杯，3.6 kcal/克
  const kcalPerCup = 360;
  const kcalPerGram = 3.6;

  function toKg(value, unit) {
    const v = Number(value) || 0;
    return unit === 'lb' ? v * 0.45359237 : v;
  }

  function factor(level) {
    if (level === 'low') return 1.2;
    if (level === 'high') return 1.6;
    return 1.4; // medium
  }

  function calc() {
    const w = document.getElementById('w').value;
    const unit = document.getElementById('unit').value;
    const act = document.getElementById('act').value;

    const kg = toKg(w, unit);
    const rer = 70 * Math.pow(kg, 0.75);
    const kcal = rer * factor(act);

    const cups = kcal / kcalPerCup;
    const grams = kcal / kcalPerGram;

    const d = (k) => (window.__i18n_get ? __i18n_get().DICT[document.documentElement.lang || 'en-US'][k] : null) || k;
    document.getElementById('r-kcal').textContent = `${kcal.toFixed(1)} ${d('feeding.kcal.day') || 'kcal/day'}`;
    document.getElementById('r-cup').textContent  = `${cups.toFixed(1)} ${d('feeding.cup.day') || 'cup/day'}`;
    document.getElementById('r-gram').textContent = `${grams.toFixed(1)} ${d('feeding.g.day') || 'g/day'}`;
  }

  document.getElementById('calc').addEventListener('click', calc);
  // 初次计算一遍
  addEventListener('DOMContentLoaded', calc);
</script>
</body>
</html>
