<!doctype html>
<html lang="zh-CN">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title data-i18n="title.feeding">喂食计算器｜Feeding Calculator</title>
  <meta name="description" content="根据体重与活动估算 RER/kcal，并换算成杯数与克数；适配移动端，支持社交分享卡片。">
  <link rel="canonical" href="https://ben-del-cmd.github.io/p-feeding/feeding.html">
  <link rel="icon" href="/p-feeding/cover.png?v=20250919">

  <!-- Open Graph / Twitter -->
  <meta property="og:type" content="website">
  <meta property="og:title" content="喂食计算器｜Feeding Calculator">
  <meta property="og:description" content="根据体重与活动估算 RER/kcal，并换算成杯数与克数。">
  <meta property="og:url" content="https://ben-del-cmd.github.io/p-feeding/feeding.html">
  <meta property="og:image" content="https://ben-del-cmd.github.io/p-feeding/cover.png?v=20250919">
  <meta name="twitter:card" content="summary_large_image">

  <!-- Phase 1 安全片段 -->
  <meta name="referrer" content="strict-origin-when-cross-origin">
  <meta http-equiv="Content-Security-Policy" content="default-src 'self'; img-src 'self' https: data:; script-src 'self' https://plausible.io 'unsafe-inline'; style-src 'self' 'unsafe-inline'; connect-src https://plausible.io; form-action 'self' https://github.com mailto:; base-uri 'none'; frame-ancestors 'self';">
  <meta name="theme-color" content="#0b0c0f">

  <!-- 顶部配置位（仅此处可改数字） -->
  <script>window.KCAL_PER_CUP=360; window.GRAMS_PER_CUP=100;</script>

  <!-- i18n -->
  <script src="/p-feeding/i18n.js?v=20250920b" defer></script>

  <!-- Plausible -->
  <script defer data-domain="ben-del-cmd.github.io" src="https://plausible.io/js/script.js"></script>

  <style>
    body{font-family:system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,'Noto Sans',sans-serif;background:#0b0c0f;color:#e6e6e6;margin:0;line-height:1.6}
    .wrap{max-width:960px;margin:0 auto;padding:32px 16px}
    a{color:#8ecaff;text-decoration:none}
    .row{display:flex;gap:12px;flex-wrap:wrap;align-items:center}
    .btn{padding:8px 12px;border-radius:10px;background:#1b2330;border:1px solid #2b3442;color:#e6e6e6}
    .btn:hover{background:#223043}
    .card{background:#11141a;border:1px solid #222833;border-radius:12px;padding:18px;margin:16px 0}
    input,select,button{font-size:16px}
    input,select{padding:10px;border-radius:10px;border:1px solid #2b3442;background:#0e131b;color:#e6e6e6}
    .res p{margin:6px 0}
  </style>
</head>
<body>
  <div class="wrap">
    <p><a href="/p-feeding/" class="btn" data-i18n="nav.home">返回主页</a></p>

    <div class="row" style="margin:6px 0 18px">
      <button class="btn" onclick="__setLang('en-US')">English</button>
      <button class="btn" onclick="__setLang('es-419')">Español</button>
      <button class="btn" onclick="__setLang('zh-Hans')">中文(简)</button>
      <button class="btn" onclick="__setLang('fr-CA')">Français (Canada)</button>
    </div>

    <h1 data-i18n="h1.feeding">喂食计算器</h1>

    <div class="card">
      <div class="row">
        <label for="w" style="min-width:84px" data-i18n="feeding.weight">体重</label>
        <input id="w" type="number" step="0.1" value="10" style="width:200px">
        <label for="unit" style="min-width:64px" data-i18n="feeding.unit">单位</label>
        <select id="unit">
          <option value="kg" data-i18n="feeding.kg">千克(kg)</option>
          <option value="lb" data-i18n="feeding.lb">磅(lb)</option>
        </select>
      </div>

      <div class="row" style="margin-top:10px">
        <label for="act" style="min-width:84px" data-i18n="feeding.activity">活动水平</label>
        <select id="act">
          <option value="low" data-i18n="feeding.low">低</option>
          <option value="mid" selected data-i18n="feeding.mid">中</option>
          <option value="high" data-i18n="feeding.high">高</option>
        </select>

        <button class="btn" id="calc" data-i18n="feeding.calc">计算</button>
      </div>

      <div class="res" style="margin-top:14px">
        <strong data-i18n="feeding.result">结果</strong>
        <p id="kcal">—</p>
        <p id="cup">—</p>
        <p id="gram">—</p>
      </div>
    </div>

    <p data-i18n="footer.note.feeding">提示：结果仅供参考，请结合兽医建议。</p>
  </div>

  <script>
    const elW = document.getElementById('w');
    const elU = document.getElementById('unit');
    const elA = document.getElementById('act');
    const elK = document.getElementById('kcal');
    const elC = document.getElementById('cup');
    const elG = document.getElementById('gram');

    function toKg(v, unit){ return unit==='lb' ? v*0.45359237 : v; }

    function factor(act){
      if(act==='low') return 1.2;
      if(act==='high') return 1.8;
      return 1.5; // mid
    }

    function rer(kg){
      // RER ~= 70 * (kg^0.75)
      return 70 * Math.pow(kg, 0.75);
    }

    function run(){
      const kg = toKg(parseFloat(elW.value||0), elU.value);
      if(!kg || kg<=0){ elK.textContent='—'; elC.textContent='—'; elG.textContent='—'; return; }
      const kcal = rer(kg) * factor(elA.value);
      const perCup = window.KCAL_PER_CUP||360;
      const gramsPerCup = window.GRAMS_PER_CUP||100;

      elK.textContent = (kcal.toFixed(1) + ' ' + (document.querySelector('[data-i18n="feeding.kcal.day"]')?.textContent || 'kcal/day'));
      elC.textContent = ((kcal/perCup).toFixed(1) + ' ' + (document.querySelector('[data-i18n="feeding.cup.day"]')?.textContent || 'cup/day'));
      elG.textContent = (((kcal/perCup)*gramsPerCup).toFixed(1) + ' ' + (document.querySelector('[data-i18n="feeding.g.day"]')?.textContent || 'g/day'));

      try{ window.plausible && window.plausible('Calculate',{props:{unit:elU.value,act:elA.value}});}catch(e){}
    }

    document.getElementById('calc').addEventListener('click', run);
    // 初始计算一次
    run();
  </script>
</body>
</html>
