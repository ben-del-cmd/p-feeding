<!doctype html>
<html lang="en-US">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title data-i18n="title.feedback">Feedback</title>
  <meta name="description" content="提交问题或功能建议，将在 GitHub 中生成一条 Issue 草稿。">
  <link rel="canonical" href="https://ben-del-cmd.github.io/p-feeding/feedback.html">
  <link rel="icon" href="/p-feeding/cover.png?v=20250919">

  <!-- Open Graph / Twitter -->
  <meta property="og:type" content="website">
  <meta property="og:url" content="https://ben-del-cmd.github.io/p-feeding/feedback.html">
  <meta property="og:title" content="问题与建议｜Feedback">
  <meta property="og:description" content="提交问题或功能建议，将在 GitHub 中生成一条 Issue 草稿。">
  <meta property="og:image" content="https://ben-del-cmd.github.io/p-feeding/cover.png?v=20250919">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:title" content="问题与建议｜Feedback">
  <meta name="twitter:description" content="提交问题或功能建议，将在 GitHub 中生成一条 Issue 草稿。">
  <meta name="twitter:image" content="https://ben-del-cmd.github.io/p-feeding/cover.png?v=20250919">

  <!-- Phase 1 安全基线 -->
  <meta name="referrer" content="strict-origin-when-cross-origin">
  <meta http-equiv="Content-Security-Policy" content="default-src 'self'; img-src 'self' https: data:; script-src 'self' https://plausible.io 'unsafe-inline'; style-src 'self' 'unsafe-inline'; connect-src https://plausible.io; form-action 'self' https://github.com mailto:; base-uri 'none'; frame-ancestors 'self';">
  <meta name="theme-color" content="#0b0c0f">

  <!-- Plausible -->
  <script defer data-domain="ben-del-cmd.github.io" src="https://plausible.io/js/script.js"></script>

  <!-- i18n（加 defer） -->
  <script defer src="/p-feeding/i18n.js?v=20250920"></script>

  <style>
    body{max-width:720px;margin:0 auto;padding:24px;line-height:1.6;font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial,Helvetica,sans-serif}
    a{color:#1d4ed8}
    .card{border:1px solid #e5e7eb;border-radius:12px;padding:16px}
    .row{display:flex;gap:12px;flex-wrap:wrap;align-items:center}
    .row>label{min-width:100px}
    input,select,textarea,button{padding:10px;border:1px solid #e5e7eb;border-radius:10px}
    textarea{width:100%;min-height:140px}
    button.primary{background:#0b0c0f;color:#fff;cursor:pointer}
    header{display:flex;justify-content:space-between;align-items:center;gap:12px}
  </style>
</head>
<body>
  <header>
    <a href="/p-feeding/" data-i18n="nav.home" rel="noopener">Home</a>
    <div>
      <button onclick="__setLang('en-US')">English</button>
      <button onclick="__setLang('es-419')">Español</button>
      <button onclick="__setLang('zh-Hans')">中文(简)</button>
      <button onclick="__setLang('fr-CA')">Français (Canada)</button>
    </div>
  </header>

  <h1 data-i18n="h1.feedback">Feedback</h1>

  <section class="card">
    <div class="row">
      <label for="t" data-i18n="form.type">Type</label>
      <select id="t">
        <option value="bug" data-i18n="form.type.bug">Bug</option>
        <option value="feature" data-i18n="form.type.feature">Feature Request</option>
      </select>
    </div>
    <div class="row" style="margin-top:12px;">
      <label for="s" data-i18n="form.summary">Summary</label>
      <input id="s" type="text" maxlength="120" data-i18n-placeholder="form.summary.ph" placeholder="One-line summary…">
    </div>
    <div class="row" style="margin-top:12px;">
      <label for="d" data-i18n="form.details">Details</label>
      <textarea id="d" data-i18n-placeholder="form.details.ph" placeholder="Steps to reproduce, expected result, screenshots/device info…"></textarea>
    </div>
    <div class="row" style="margin-top:12px;">
      <button id="go" class="primary" data-i18n="btn.preview">Preview Draft</button>
    </div>
    <p style="margin-top:8px;color:#6b7280;font-size:14px;" data-i18n="footer.note.feedback">You will be redirected to GitHub to review and submit.</p>
  </section>

  <footer style="margin-top:24px;color:#6b7280;font-size:14px;">
    <small>© p-feeding</small>
  </footer>

  <script>
    (function(){
      const repo = 'https://github.com/ben-del-cmd/p-feeding/issues/new';
      document.getElementById('go').addEventListener('click', function(){
        const lang = document.documentElement.lang || 'en-US';
        const type = document.getElementById('t').value;
        const summary = (document.getElementById('s').value||'').trim();
        const details = (document.getElementById('d').value||'').trim();
        const template = type==='bug' ? 'bug_report.yml' : 'feature_request.yml';
        const body = details + '\n\n' + '— From p-feeding/feedback.html';
        const params = new URLSearchParams();
        params.set('template', template);
        if(summary) params.set('title', summary);
        if(body) params.set('body', body);
        try{ window.plausible && window.plausible('Feedback', { props: { lang, type } }); }catch(e){}
        location.href = repo + '?' + params.toString();
      });
    })();
  </script>
</body>
</html>
