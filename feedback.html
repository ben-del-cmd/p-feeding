<!doctype html>
<html lang="zh-CN">
<!-- Pet Scan · Feedback · v20250922h -->
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Pet Scan</title>
  <meta name="description" content="Pet Scan feedback" />
  <meta name="robots" content="index,follow" />

  <link rel="preconnect" href="https://plausible.io" crossorigin />
  <link rel="dns-prefetch" href="https://plausible.io" />

  <script>
  (function(){
    var domain = (location && location.hostname) ? location.hostname : 'localhost';
    var s = document.createElement('script'); s.defer = true;
    s.setAttribute('data-domain', domain); s.src = 'https://plausible.io/js/script.js';
    document.head.appendChild(s);
  })();
  </script>

  <script defer src="i18n.js?v=20250922h"></script>
  <script type="module" src="assets/js/events.js?v=20250922h"></script>

  <style>
    :root{--bg:#0b0d12;--fg:#e5e7eb;--muted:#9ca3af;--card:#111827;--btn:#10b981;--btnfg:#0b0d12;--outline:rgba(255,255,255,.08);--br:16px}
    *{box-sizing:border-box} html,body{height:100%}
    body{margin:0;background:linear-gradient(180deg,#0b0d12,#0f172a);color:var(--fg);font:15px/1.6 system-ui,-apple-system,"Segoe UI",Roboto,Helvetica,Arial,"PingFang SC","Microsoft Yahei","Noto Sans",sans-serif}
    .wrap{max-width:980px;margin:0 auto;padding:28px}
    header{display:flex;align-items:center;justify-content:space-between;margin-bottom:24px}
    .logo{display:flex;align-items:center;gap:10px;font-weight:700;font-size:16px;color:#fff;text-decoration:none}
    .logo-badge{width:28px;height:28px;border-radius:8px;background:#10b981;display:inline-grid;place-items:center;color:#0b0d12;font-weight:900}
    .nav a{color:var(--muted);text-decoration:none;margin-left:16px}
    .lang{margin-left:16px;padding:6px 10px;border-radius:10px;border:1px solid rgba(255,255,255,.15);background:transparent;color:#cbd5e1;cursor:pointer}
    .page{background:rgba(17,24,39,.6);border:1px solid var(--outline);border-radius:var(--br);padding:24px;box-shadow:0 10px 30px rgba(0,0,0,.25)}
    h1{margin:0 0 6px;font-size:22px} p.lead{margin:0 0 16px;color:#cbd5e1}
    .card{background:var(--card);border:1px solid var(--outline);border-radius:14px;padding:16px}
    .grid{display:grid;grid-template-columns:1fr 1fr;gap:16px}
    label{display:block;margin:10px 0 6px;color:#cbd5e1}
    input,select,textarea{width:100%;padding:10px 12px;border-radius:12px;border:1px solid var(--outline);background:#0f172a;color:#e5e7eb}
    textarea{min-height:140px;resize:vertical}
    .row{display:grid;grid-template-columns:1fr 1fr;gap:12px}
    .btn{display:inline-block;padding:12px 16px;border-radius:12px;background:var(--btn);color:var(--btnfg);font-weight:800;border:0;cursor:pointer}
    .btn.sec{background:#374151;color:#e5e7eb}
    .btn.ghost{background:transparent;border:1px solid var(--outline)}
    .muted{color:var(--muted);font-size:12px}
    .note{margin-top:12px;color:#94a3b8;font-size:13px}
    .mono{font-family:ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace}
    footer{margin:28px 0 8px;color:#94a3b8;font-size:12px}
    @media (max-width:900px){.grid{grid-template-columns:1fr}}
  </style>
</head>

<body>
<div class="wrap">
  <header>
    <a class="logo" href="./">
      <span class="logo-badge">PS</span> <span>Pet Scan</span>
    </a>
    <nav class="nav">
      <a href="./"><span data-i18n="nav_home">首页</span></a>
      <a href="feeding.html"><span data-i18n="nav_feeding">喂食计算器</span></a>
      <a href="cards/transition-7.html?v=20250922h" rel="nofollow"><span data-i18n="nav_card7">7天换粮卡</span></a>
      <button id="langToggle" class="lang" type="button">中</button>
    </nav>
  </header>

  <main class="page" data-page="feedback">
    <h1 data-i18n="fb_title">意见反馈</h1>
    <p class="lead" data-i18n="fb_lead">帮助我们提升命中率与解释易读性…</p>

    <div class="grid">
      <!-- 左：提交区 -->
      <section class="card">
        <h3 data-i18n="fb_form_title">填写信息</h3>

        <div class="row">
          <div>
            <label for="cat" data-i18n="fb_cat">类别</label>
            <select id="cat">
              <option value="hit" data-i18n="fb_opt_hit">命中</option>
              <option value="mismatch" data-i18n="fb_opt_mismatch">识别错误/不一致</option>
              <option value="ux" data-i18n="fb_opt_ux">可用性问题</option>
              <option value="suggest" data-i18n="fb_opt_suggest">功能建议</option>
              <option value="other" data-i18n="fb_opt_other">其他</option>
            </select>
          </div>
          <div>
            <label for="contact" data-i18n="fb_allow_contact">是否允许联系你（可选）</label>
            <select id="contact">
              <option value="no" selected data-i18n="fb_allow_no">否</option>
              <option value="yes" data-i18n="fb_allow_yes">是</option>
            </select>
          </div>
        </div>

        <div class="row">
          <div>
            <label for="brand" data-i18n="fb_brand">品牌（可选）</label>
            <input id="brand" data-i18n="fb_brand_ph" data-i18n-attr="placeholder" placeholder="例如：Brand A" />
          </div>
          <div>
            <label for="product" data-i18n="fb_product">产品/口味（可选）</label>
            <input id="product" data-i18n="fb_product_ph" data-i18n-attr="placeholder" placeholder="例如：Adult Chicken" />
          </div>
        </div>

        <label for="link" data-i18n="fb_link">相关链接/图片（可选）</label>
        <input id="link" data-i18n="fb_link_ph" data-i18n-attr="placeholder" placeholder="SKU/页面/图片链接" />

        <label for="desc" data-i18n="fb_desc">详细描述（必填）</label>
        <textarea id="desc" data-i18n="fb_desc_ph" data-i18n-attr="placeholder" placeholder="请尽量描述…"></textarea>
        <div class="muted"><span id="counter">0</span> <span data-i18n="fb_desc_count_unit">字</span></div>

        <div style="margin-top:14px;display:flex;gap:10px;flex-wrap:wrap">
          <button class="btn" id="sendBtn" data-i18n="fb_send">发邮件</button>
          <button class="btn sec" id="copyBtn" data-i18n="fb_copy">复制反馈文本</button>
          <a class="btn ghost" href="./" id="backHome" data-i18n="fb_back">返回首页</a>
          <span id="tip" class="muted"></span>
        </div>

        <div class="note" data-i18n="fb_note">
          我们默认会在匿名聚合层面使用反馈数据……
        </div>
      </section>

      <!-- 右：说明区 -->
      <section class="card">
        <h3 data-i18n="fb_right_title">说明</h3>
        <ul style="margin:0 0 8px 18px">
          <li data-i18n="fb_right_hit">命中…</li>
          <li data-i18n="fb_right_mis">识别错误/不一致…</li>
          <li data-i18n="fb_right_ux">可用性问题…</li>
          <li data-i18n="fb_right_sug">功能建议…</li>
        </ul>
        <div class="note">
          <div data-i18n="fb_right_safety">安全与边界…</div>
          <div data-i18n="fb_right_neutral">中立性…</div>
          <div id="metaLine" class="muted" style="margin-top:6px"></div>
        </div>
      </section>
    </div>
  </main>

  <footer>
    <div class="i18n-footer">© <span class="mono">Pet Scan</span> · <span class="muted">信息性建议（非医疗）</span></div>
  </footer>
</div>

<script>
  const desc = document.getElementById('desc');
  const counter = document.getElementById('counter');
  desc.addEventListener('input', ()=>{ counter.textContent = Math.min(1000, desc.value.length); });

  function payload(){
    const d = new Date().toISOString().replace('T',' ').replace('Z',' UTC');
    const data = {
      path: location.pathname + location.search,
      category: document.getElementById('cat').value,
      allow_contact: document.getElementById('contact').value,
      brand: document.getElementById('brand').value.trim(),
      product: document.getElementById('product').value.trim(),
      link: document.getElementById('link').value.trim(),
      desc: desc.value.trim(),
      ts: d,
      ver: 'v20250922h'
    };
    return (
`[Pet Scan 反馈]
分类: ${data.category}
允许联系: ${data.allow_contact}
品牌: ${data.brand || '-'}
产品: ${data.product || '-'}

链接: ${data.link || '-'}

详细描述:
${data.desc || '(未填写)'}

页面: ${data.path}
时间: ${data.ts}
版本: ${data.ver}`);
  }

  document.getElementById('copyBtn').addEventListener('click', async ()=>{
    const text = payload();
    try{
      await navigator.clipboard.writeText(text);
      document.getElementById('tip').textContent = (window.__PS_FB_COPY_OK__ || 'Copied to clipboard ✅');
      document.getElementById('tip').className = 'muted';
      try{ window.plausible && window.plausible('feedback_click', { props:{ action:'copy' } }); }catch(e){}
    }catch(e){
      document.getElementById('tip').textContent = (window.__PS_FB_COPY_FAIL__ || 'Copy failed');
      document.getElementById('tip').className = 'muted';
    }
  });

  document.getElementById('sendBtn').addEventListener('click', ()=>{
    const text = payload();
    const body = encodeURIComponent(text);
    const subject = encodeURIComponent('Pet Scan 反馈');
    const url = `mailto:?subject=${subject}&body=${body}`;
    try{ window.plausible && window.plausible('feedback_click', { props:{ action:'mailto' } }); }catch(e){}
    window.location.href = url;
  });

  (function(){
    const ts = new Date().toISOString().replace('T',' ').replace('Z',' UTC');
    document.getElementById('metaLine').textContent =
      '数据与中立披露已启用；时间戳 ' + ts + '；版本 v20250922h。';
  })();

  try{ window.plausible && window.plausible('feedback_open', { props:{ from: document.referrer ? 'referrer' : 'direct' } }); }catch(e){}
</script>
</body>
</html>
