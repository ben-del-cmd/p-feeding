<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <title data-i18n="title.feedback">Feedback</title>
  <meta name="description" content="Report a bug or suggest a feature. Draft will open on GitHub for final submission." />
  <link rel="canonical" href="https://ben-del-cmd.github.io/p-feeding/feedback.html" />
  <link rel="icon" href="/p-feeding/cover.png">

  <!-- Security baseline (Phase 1) -->
  <meta name="referrer" content="strict-origin-when-cross-origin">
  <meta http-equiv="Content-Security-Policy" content="default-src 'self'; img-src 'self' https: data:; script-src 'self' https://plausible.io 'unsafe-inline'; style-src 'self' 'unsafe-inline'; connect-src https://plausible.io; form-action 'self' https://github.com mailto:; base-uri 'none'; frame-ancestors 'self';">
  <meta name="theme-color" content="#0b0c0f">

  <!-- Open Graph -->
  <meta property="og:type" content="website" />
  <meta property="og:site_name" content="Pet Feeding Tools" />
  <meta property="og:title" content="Feedback" />
  <meta property="og:description" content="Report a bug or suggest a feature. Draft will open on GitHub for final submission." />
  <meta property="og:url" content="https://ben-del-cmd.github.io/p-feeding/feedback.html" />
  <meta property="og:image" content="https://ben-del-cmd.github.io/p-feeding/cover.png?v=20250919" />

  <!-- Plausible -->
  <script defer data-domain="ben-del-cmd.github.io" src="https://plausible.io/js/script.js"></script>
  <!-- i18n -->
  <script src="/p-feeding/i18n.js?v=20250920b" defer></script>

  <style>
    body{font-family:system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,"Noto Sans","PingFang SC","Hiragino Sans GB",sans-serif;line-height:1.6;margin:0;padding:0 16px 48px;color:#111}
    header{display:flex;gap:12px;align-items:center;padding:16px 0}
    .btn{display:inline-block;padding:10px 16px;border:1px solid #d0d7de;border-radius:8px;text-decoration:none;color:#111;background:#fff}
    .btn:hover{background:#f6f8fa}
    h1{font-size:40px;margin:16px 0}
    .card{border:1px solid #e5e7eb;border-radius:12px;padding:16px;margin:24px 0}
    input,select,textarea,button{padding:10px;border:1px solid #d0d7de;border-radius:8px}
    textarea{width:100%;min-height:220px}
    .langbar{display:flex;gap:12px;margin:0 0 0 auto}
  </style>
</head>
<body>
  <header>
    <a class="btn" href="/p-feeding/" data-i18n="nav.home">Home</a>
    <div class="langbar">
      <button class="btn" onclick="__setLang('en-US')">English</button>
      <button class="btn" onclick="__setLang('es-419')">Español</button>
      <button class="btn" onclick="__setLang('zh-Hans')">中文(简)</button>
      <button class="btn" onclick="__setLang('fr-CA')">Français (Canada)</button>
    </div>
  </header>

  <main>
    <h1 data-i18n="h1.feedback">Feedback</h1>

    <section class="card">
      <label>
        <span data-i18n="form.type">Type</span><br />
        <select id="ftype">
          <option value="bug" data-i18n="form.type.bug">Bug</option>
          <option value="feature" data-i18n="form.type.feature">Feature Request</option>
        </select>
      </label>

      <div style="height:12px"></div>

      <label>
        <span data-i18n="form.summary">Summary</span><br />
        <input id="summary" type="text" style="width:100%" data-i18n-placeholder="form.summary.ph" placeholder="One-line summary…" />
      </label>

      <div style="height:12px"></div>

      <label>
        <span data-i18n="form.details">Details</span><br />
        <textarea id="details" data-i18n-placeholder="form.details.ph" placeholder="Steps to reproduce, expected result, screenshots/device info…"></textarea>
      </label>

      <div style="height:12px"></div>

      <button class="btn" id="go" data-i18n="btn.preview">Preview Draft</button>

      <p class="muted" data-i18n="footer.note.feedback" style="color:#667085;margin-top:12px">
        You will be redirected to GitHub to review and submit.
      </p>
    </section>
  </main>

  <script>
    // 页面打开即上报 feedback_open
    (function(){
      try { plausible('feedback_open', { props: { path: location.pathname } }); } catch(e) {}
    })();

    // “预览草稿”按钮：跳到 GitHub 新 issue
    document.getElementById('go').addEventListener('click', function(){
      const type = document.getElementById('ftype').value;
      const title = (document.getElementById('summary').value || '').trim();
      const body = (document.getElementById('details').value || '').trim();

      const url = new URL('https://github.com/ben-del-cmd/p-feeding/issues/new');
      url.searchParams.set('title', title || '[Feedback]');
      url.searchParams.set('labels', type === 'bug' ? 'bug' : 'enhancement');
      url.searchParams.set('body',
        `Type: ${type}\n\nSummary: ${title}\n\nDetails:\n${body}\n\n(from p-feeding/feedback.html)`
      );

      try{ plausible('feedback_preview_click'); }catch(e){}
      window.open(url.toString(), '_blank','noopener');
    });
  </script>
</body>
</html>
